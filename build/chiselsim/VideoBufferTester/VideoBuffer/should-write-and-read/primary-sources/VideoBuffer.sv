// Generated by CIRCT firtool-1.133.0

// Include register initializers in init blocks unless synthesis is set
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_REG_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_REG_INIT
`endif // not def RANDOMIZE
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_REG_
    `define ENABLE_INITIAL_REG_
  `endif // not def ENABLE_INITIAL_REG_
`endif // not def SYNTHESIS

// Standard header to adapt well known macros for register randomization.

// RANDOM may be set to an expression that produces a 32-bit random unsigned value.
`ifndef RANDOM
  `define RANDOM $random
`endif // not def RANDOM

// Users can define INIT_RANDOM as general code that gets injected into the
// initializer block for modules with registers.
`ifndef INIT_RANDOM
  `define INIT_RANDOM
`endif // not def INIT_RANDOM

// If using random initialization, you can also define RANDOMIZE_DELAY to
// customize the delay used, otherwise 0.002 is used.
`ifndef RANDOMIZE_DELAY
  `define RANDOMIZE_DELAY 0.002
`endif // not def RANDOMIZE_DELAY

// Define INIT_RANDOM_PROLOG_ for use in our modules below.
`ifndef INIT_RANDOM_PROLOG_
  `ifdef RANDOMIZE
    `ifdef VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM
    `else  // VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM #`RANDOMIZE_DELAY begin end
    `endif // VERILATOR
  `else  // RANDOMIZE
    `define INIT_RANDOM_PROLOG_
  `endif // RANDOMIZE
`endif // not def INIT_RANDOM_PROLOG_
module VideoBuffer(	// AgileHWProject/src/VideoBuffer.scala:7:7
  input         clock,	// AgileHWProject/src/VideoBuffer.scala:7:7
                reset,	// AgileHWProject/src/VideoBuffer.scala:7:7
  output [11:0] io_VGA_RGB,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input         io_VGA_hSync,	// AgileHWProject/src/VideoBuffer.scala:10:14
                io_VGA_vSync,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input  [3:0]  io_VGA_R,	// AgileHWProject/src/VideoBuffer.scala:10:14
                io_VGA_G,	// AgileHWProject/src/VideoBuffer.scala:10:14
                io_VGA_B,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input  [9:0]  io_VGA_horCntr,	// AgileHWProject/src/VideoBuffer.scala:10:14
                io_VGA_verCntr,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input         io_request,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output        io_tilelink_a_ready,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input         io_tilelink_a_valid,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input  [2:0]  io_tilelink_a_bits_opcode,	// AgileHWProject/src/VideoBuffer.scala:10:14
                io_tilelink_a_bits_param,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input  [23:0] io_tilelink_a_bits_size,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input  [3:0]  io_tilelink_a_bits_source,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input  [10:0] io_tilelink_a_bits_address,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input  [2:0]  io_tilelink_a_bits_mask,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input  [23:0] io_tilelink_a_bits_data,	// AgileHWProject/src/VideoBuffer.scala:10:14
  input         io_tilelink_a_bits_corrupt,	// AgileHWProject/src/VideoBuffer.scala:10:14
                io_tilelink_d_ready,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output        io_tilelink_d_valid,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output [2:0]  io_tilelink_d_bits_opcode,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output [1:0]  io_tilelink_d_bits_param,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output [23:0] io_tilelink_d_bits_size,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output [3:0]  io_tilelink_d_bits_source,	// AgileHWProject/src/VideoBuffer.scala:10:14
                io_tilelink_d_bits_sink,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output        io_tilelink_d_bits_denied,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output [23:0] io_tilelink_d_bits_data,	// AgileHWProject/src/VideoBuffer.scala:10:14
  output        io_tilelink_d_bits_corrupt	// AgileHWProject/src/VideoBuffer.scala:10:14
);

  reg  [10:0] Tail;	// AgileHWProject/src/VideoBuffer.scala:18:21
  reg  [3:0]  stateReg;	// AgileHWProject/src/VideoBuffer.scala:22:25
  reg  [23:0] burstCounter;	// AgileHWProject/src/VideoBuffer.scala:23:29
  reg  [3:0]  sourceReg;	// AgileHWProject/src/VideoBuffer.scala:24:26
  wire [10:0] _GEN = Tail == 11'h403 ? 11'h0 : Tail + 11'h1;	// AgileHWProject/src/VideoBuffer.scala:18:21, :41:{15,35,42}, :42:12, :46:{12,20}
  wire        _GEN_0 = stateReg == 4'h0;	// AgileHWProject/src/VideoBuffer.scala:22:25, :51:19
  wire        _GEN_1 = io_tilelink_a_valid & io_tilelink_a_bits_opcode == 3'h0;	// AgileHWProject/src/VideoBuffer.scala:54:{32,61}
  wire        _GEN_2 = stateReg == 4'h1;	// AgileHWProject/src/VideoBuffer.scala:22:25, :51:19
  wire        _GEN_3 = stateReg == 4'h2;	// AgileHWProject/src/VideoBuffer.scala:22:25, :51:19, :80:18
  wire        _GEN_4 = _GEN_0 | _GEN_2;	// AgileHWProject/src/VideoBuffer.scala:27:23, :51:19
  always @(posedge clock) begin	// AgileHWProject/src/VideoBuffer.scala:7:7
    if (reset) begin	// AgileHWProject/src/VideoBuffer.scala:7:7
      Tail <= 11'h0;	// AgileHWProject/src/VideoBuffer.scala:18:21
      stateReg <= 4'h0;	// AgileHWProject/src/VideoBuffer.scala:22:25
      burstCounter <= 24'h0;	// AgileHWProject/src/VideoBuffer.scala:23:29
      sourceReg <= 4'h0;	// AgileHWProject/src/VideoBuffer.scala:24:26
    end
    else begin	// AgileHWProject/src/VideoBuffer.scala:7:7
      if (io_request)	// AgileHWProject/src/VideoBuffer.scala:10:14
        Tail <= _GEN;	// AgileHWProject/src/VideoBuffer.scala:18:21, :41:42, :42:12, :46:12
      if (_GEN_0) begin	// AgileHWProject/src/VideoBuffer.scala:51:19
        if (_GEN_1)	// AgileHWProject/src/VideoBuffer.scala:54:32
          stateReg <= {3'h0, |io_tilelink_a_bits_size};	// AgileHWProject/src/VideoBuffer.scala:22:25, :62:{38,46}, :63:20, :66:20
        if (_GEN_1 & (|io_tilelink_a_bits_size))	// AgileHWProject/src/VideoBuffer.scala:23:29, :54:{32,69}, :62:{38,46}, :64:24
          burstCounter <= 24'h1;	// AgileHWProject/src/VideoBuffer.scala:23:29
      end
      else begin	// AgileHWProject/src/VideoBuffer.scala:51:19
        automatic logic _GEN_5;	// AgileHWProject/src/VideoBuffer.scala:76:25
        _GEN_5 = burstCounter < io_tilelink_a_bits_size;	// AgileHWProject/src/VideoBuffer.scala:23:29, :76:25
        if (_GEN_2)	// AgileHWProject/src/VideoBuffer.scala:51:19
          stateReg <= _GEN_5 ? 4'h1 : 4'h2;	// AgileHWProject/src/VideoBuffer.scala:22:25, :51:19, :76:{25,51}, :78:18, :80:18
        else if (_GEN_3 & io_tilelink_d_ready)	// AgileHWProject/src/VideoBuffer.scala:22:25, :51:19, :98:32, :99:18
          stateReg <= 4'h0;	// AgileHWProject/src/VideoBuffer.scala:22:25
        if (_GEN_2 & _GEN_5)	// AgileHWProject/src/VideoBuffer.scala:23:29, :51:19, :76:{25,51}, :77:22
          burstCounter <= burstCounter + 24'h1;	// AgileHWProject/src/VideoBuffer.scala:23:29, :77:38
      end
      if (_GEN_0 & _GEN_1)	// AgileHWProject/src/VideoBuffer.scala:24:26, :51:19, :54:{32,69}, :56:19
        sourceReg <= io_tilelink_a_bits_source;	// AgileHWProject/src/VideoBuffer.scala:24:26
    end
  end // always @(posedge)
  `ifdef ENABLE_INITIAL_REG_	// AgileHWProject/src/VideoBuffer.scala:7:7
    `ifdef FIRRTL_BEFORE_INITIAL	// AgileHWProject/src/VideoBuffer.scala:7:7
      `FIRRTL_BEFORE_INITIAL	// AgileHWProject/src/VideoBuffer.scala:7:7
    `endif // FIRRTL_BEFORE_INITIAL
    initial begin	// AgileHWProject/src/VideoBuffer.scala:7:7
      automatic logic [31:0] _RANDOM[0:1];	// AgileHWProject/src/VideoBuffer.scala:7:7
      `ifdef INIT_RANDOM_PROLOG_	// AgileHWProject/src/VideoBuffer.scala:7:7
        `INIT_RANDOM_PROLOG_	// AgileHWProject/src/VideoBuffer.scala:7:7
      `endif // INIT_RANDOM_PROLOG_
      `ifdef RANDOMIZE_REG_INIT	// AgileHWProject/src/VideoBuffer.scala:7:7
        for (logic [1:0] i = 2'h0; i < 2'h2; i += 2'h1) begin
          _RANDOM[i[0]] = `RANDOM;	// AgileHWProject/src/VideoBuffer.scala:7:7
        end	// AgileHWProject/src/VideoBuffer.scala:7:7
        Tail = _RANDOM[1'h0][10:0];	// AgileHWProject/src/VideoBuffer.scala:7:7, :18:21
        stateReg = _RANDOM[1'h0][14:11];	// AgileHWProject/src/VideoBuffer.scala:7:7, :18:21, :22:25
        burstCounter = {_RANDOM[1'h0][31:15], _RANDOM[1'h1][6:0]};	// AgileHWProject/src/VideoBuffer.scala:7:7, :18:21, :23:29
        sourceReg = _RANDOM[1'h1][10:7];	// AgileHWProject/src/VideoBuffer.scala:7:7, :23:29, :24:26
      `endif // RANDOMIZE_REG_INIT
    end // initial
    `ifdef FIRRTL_AFTER_INITIAL	// AgileHWProject/src/VideoBuffer.scala:7:7
      `FIRRTL_AFTER_INITIAL	// AgileHWProject/src/VideoBuffer.scala:7:7
    `endif // FIRRTL_AFTER_INITIAL
  `endif // ENABLE_INITIAL_REG_
  DualPortRAM Mem (	// AgileHWProject/src/VideoBuffer.scala:19:19
    .clock              (clock),
    .io_Write_valid     (_GEN_0 ? _GEN_1 : _GEN_2),	// AgileHWProject/src/VideoBuffer.scala:51:19, :54:{32,69}
    .io_Write_bits_addr
      (_GEN_0
         ? (_GEN_1 ? io_tilelink_a_bits_address : 11'h0)
         : _GEN_2 ? io_tilelink_a_bits_address + burstCounter[10:0] : 11'h0),	// AgileHWProject/src/VideoBuffer.scala:23:29, :36:26, :51:19, :54:{32,69}, :59:32, :73:{30,60}
    .io_Write_bits_data
      ((_GEN_0 ? _GEN_1 : _GEN_2) ? io_tilelink_a_bits_data[11:0] : 12'h0),	// AgileHWProject/src/VideoBuffer.scala:37:26, :51:19, :54:{32,69}, :60:32, :74:30
    .io_Read_addr       (io_request ? _GEN : Tail),	// AgileHWProject/src/VideoBuffer.scala:18:21, :32:20, :40:19, :41:42, :42:12, :46:12
    .io_Read_data       (io_VGA_RGB)
  );	// AgileHWProject/src/VideoBuffer.scala:19:19
  assign io_tilelink_a_ready = _GEN_4 | stateReg != 4'h2;	// AgileHWProject/src/VideoBuffer.scala:7:7, :22:25, :27:23, :51:19, :80:18, :85:27
  assign io_tilelink_d_valid = ~_GEN_4 & _GEN_3;	// AgileHWProject/src/VideoBuffer.scala:7:7, :27:23, :28:23, :51:19
  assign io_tilelink_d_bits_opcode = 3'h0;	// AgileHWProject/src/VideoBuffer.scala:7:7
  assign io_tilelink_d_bits_param = 2'h0;	// AgileHWProject/src/VideoBuffer.scala:7:7
  assign io_tilelink_d_bits_size = 24'h0;	// AgileHWProject/src/VideoBuffer.scala:7:7
  assign io_tilelink_d_bits_source = sourceReg;	// AgileHWProject/src/VideoBuffer.scala:7:7, :24:26
  assign io_tilelink_d_bits_sink = 4'h0;	// AgileHWProject/src/VideoBuffer.scala:7:7
  assign io_tilelink_d_bits_denied = 1'h0;	// AgileHWProject/src/VideoBuffer.scala:7:7
  assign io_tilelink_d_bits_data = 24'h0;	// AgileHWProject/src/VideoBuffer.scala:7:7
  assign io_tilelink_d_bits_corrupt = 1'h0;	// AgileHWProject/src/VideoBuffer.scala:7:7
endmodule

